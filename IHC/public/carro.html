<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√öltimo Paso - LicorPremium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        .header {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1410 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }

        .container {
            max-width: 900px;
            margin: 30px auto;
            padding: 0 20px;
        }

        /* LAYOUT 2 COLUMNAS */
        .checkout-wrapper {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            align-items: start;
        }

        @media (max-width: 768px) {
            .checkout-wrapper {
                grid-template-columns: 1fr;
            }
        }

        /* FORMULARIO */
        .checkout-form {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .form-section {
            margin-bottom: 30px;
        }

        .form-section h2 {
            font-size: 18px;
            color: #D4AF37;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #D4AF37;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-section h2 i {
            font-size: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row.full {
            grid-template-columns: 1fr;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
            font-size: 14px;
        }

        label .required {
            color: #c0392b;
        }

        input, select, textarea {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            font-size: 14px;
            transition: all 0.3s;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #D4AF37;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }

        input.error, select.error {
            border-color: #c0392b;
            background-color: #ffebee;
        }

        .error-message {
            color: #c0392b;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        /* CHECKBOX */
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin: 15px 0;
        }

        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            min-width: 20px;
            min-height: 20px;
            flex-shrink: 0;
            margin-top: 2px;
            cursor: pointer;
        }

        .checkbox-label {
            font-size: 13px;
            line-height: 1.5;
            margin: 0;
        }

        .checkbox-label strong {
            font-weight: 600;
            font-size: 13px;
        }

        .checkbox-label a {
            color: #D4AF37;
            text-decoration: none;
        }

        .checkbox-label a:hover {
            text-decoration: underline;
        }

        /* M√âTODO DE PAGO */
        .payment-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .payment-option {
            position: relative;
        }

        .payment-option input[type="radio"] {
            display: none;
        }

        .payment-label {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            font-weight: 600;
            gap: 10px;
        }

        .payment-option input[type="radio"]:checked + .payment-label {
            border-color: #D4AF37;
            background-color: #fffef8;
            color: #D4AF37;
        }

        /* M√âTODOS DE ENTREGA */
        .delivery-methods {
            margin-bottom: 25px;
        }

        .delivery-option input[type="radio"] {
            display: none;
        }

        .delivery-option label {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: white !important;
            cursor: pointer;
            transition: all 0.3s;
        }

        .delivery-option label div {
            flex: 1;
        }

        .delivery-option label span {
            font-size: 13px;
            color: #666;
            display: block;
            margin-top: 5px;
        }

        .delivery-option i {
            font-size: 28px;
            color: #D4AF37;
            transition: all 0.3s;
        }

        .delivery-option input[type="radio"]:checked + label {
            border-color: #D4AF37 !important;
            background: linear-gradient(135deg, #FFFEF8 0%, #FFF9E6 100%) !important;
            box-shadow: 0 4px 16px rgba(212, 175, 55, 0.3) !important;
            border-width: 3px !important;
        }

        .delivery-option input[type="radio"]:checked + label i {
            color: #FFD700 !important;
            transform: scale(1.2);
        }

        .delivery-option input[type="radio"]:checked + label strong {
            color: #D4AF37 !important;
        }

        .delivery-option label:hover {
            border-color: #D4AF37;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        /* BLOQUES INFORMATIVOS VERDES (Retiro e Instrucciones) */
        .info-box-green {
            background: #E8F5E9;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
            margin-top: 15px;
        }

        .info-box-green h4 {
            color: #2E7D32;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-box-green ul {
            margin-left: 20px;
            color: #33691E;
            font-size: 14px;
            line-height: 1.8;
        }

        .info-box-green li {
            color: #33691E;
        }

        .info-box-green strong {
            color: #2E7D32;
        }

        .info-box-green p {
            color: #1B5E20;
            font-size: 13px;
        }

        /* INDICADOR VISUAL DE SELECCI√ìN */
        .payment-option input[type="radio"]:checked + .payment-label {
            border-color: #D4AF37;
            background: linear-gradient(135deg, #FFFEF8 0%, #FFF9E6 100%);
            color: #D4AF37;
            border-width: 3px;
            box-shadow: 0 4px 16px rgba(212, 175, 55, 0.3);
        }

        .payment-option input[type="radio"]:checked + .payment-label i {
            color: #FFD700;
            transform: scale(1.2);
        }

        /* RESUMEN CARRITO */
        .order-summary {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 20px;
        }

        .order-summary h2 {
            font-size: 18px;
            color: #D4AF37;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .item-info {
            flex: 1;
        }

        .item-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .item-qty {
            font-size: 13px;
            color: #666;
        }

        .item-price {
            font-weight: 700;
            color: #D4AF37;
            font-size: 16px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .summary-row.total {
            border-bottom: 2px solid #D4AF37;
            font-size: 18px;
            font-weight: 700;
            color: #D4AF37;
            padding: 15px 0;
        }

        .summary-label {
            color: #666;
        }

        .summary-value {
            font-weight: 600;
        }

        /* BOT√ìN */
        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #D4AF37 0%, #FFD700 100%);
            color: #0a0a0a;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* TRUST BADGES */
        .trust-badges {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            flex-wrap: wrap;
        }

        .badge {
            text-align: center;
            font-size: 12px;
            color: #666;
        }

        .badge i {
            display: block;
            font-size: 24px;
            color: #D4AF37;
            margin-bottom: 5px;
        }

        /* MENSAJES */
        .alert {
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            display: none;
        }

        .alert.show {
            display: block;
        }

        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        /* LOADER */
        .loader {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .loader.show {
            display: flex;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #D4AF37;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Animaci√≥n de shake para campos con error */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        /* Estilos mejorados para bot√≥n disabled */
        button[disabled],
        button:disabled {
            opacity: 0.6 !important;
            cursor: not-allowed !important;
            pointer-events: none;
        }

        button[disabled]:hover,
        button:disabled:hover {
            transform: none !important;
            box-shadow: none !important;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 22px;
            }

            .checkout-form {
                padding: 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .payment-methods {
                grid-template-columns: 1fr;
            }

            .order-summary {
                position: static;
            }
        }

        /* ============================================
           MODO OSCURO - Premium Black & Gold
           ============================================ */
        
        body.dark-mode {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1410 100%);
            color: #FFFFFF;
        }

        body.dark-mode .header {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1410 100%);
            border-bottom: 2px solid rgba(212, 175, 55, 0.3);
        }

        body.dark-mode .checkout-form,
        body.dark-mode .order-summary {
            background: #1a1410;
            color: #FFFFFF;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }

        body.dark-mode .form-section h2 {
            color: #FFD700;
            border-bottom-color: #D4AF37;
        }

        body.dark-mode input,
        body.dark-mode select,
        body.dark-mode textarea {
            background: #252525;
            color: #FFFFFF;
            border-color: rgba(212, 175, 55, 0.3);
        }

        body.dark-mode input:focus,
        body.dark-mode select:focus,
        body.dark-mode textarea:focus {
            border-color: #D4AF37;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
        }

        body.dark-mode label {
            color: #E8E8E8;
        }

        body.dark-mode .btn-primary {
            background: linear-gradient(135deg, #D4AF37 0%, #FFD700 100%);
            color: #0a0a0a;
        }

        body.dark-mode .btn-primary:hover {
            box-shadow: 0 8px 24px rgba(212, 175, 55, 0.5);
        }

        body.dark-mode .summary-row {
            border-bottom-color: rgba(212, 175, 55, 0.2);
        }

        body.dark-mode .summary-row.total {
            border-bottom-color: #D4AF37;
            color: #FFD700;
        }

        body.dark-mode .cart-item {
            border-bottom-color: rgba(212, 175, 55, 0.2);
        }

        body.dark-mode .delivery-option label,
        body.dark-mode .payment-label {
            background: #252525;
            border-color: rgba(212, 175, 55, 0.3);
            color: #FFFFFF;
        }

        body.dark-mode .delivery-option label,
        body.dark-mode .payment-label {
            background: #252525 !important;
            border-color: rgba(212, 175, 55, 0.3);
            color: #FFFFFF;
        }

        body.dark-mode .delivery-option label span {
            color: #B8B8B8;
        }

        body.dark-mode .delivery-option input[type="radio"]:checked + label span {
            color: #E8E8E8;
        }

        body.dark-mode .delivery-option input[type="radio"]:checked + label,
        body.dark-mode .payment-option input[type="radio"]:checked + .payment-label {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.3) 0%, rgba(255, 215, 0, 0.2) 100%) !important;
            border-color: #FFD700 !important;
            border-width: 3px !important;
            color: #FFD700;
            box-shadow: 0 4px 16px rgba(212, 175, 55, 0.4) !important;
        }

        body.dark-mode .delivery-option input[type="radio"]:checked + label i,
        body.dark-mode .payment-option input[type="radio"]:checked + .payment-label i {
            color: #FFD700;
            transform: scale(1.2);
        }

        /* Datos bancarios en modo oscuro - igual que instrucciones de retiro */
        body.dark-mode #datosTransferencia {
            background: rgba(232, 245, 233, 0.1) !important;
            border-left-color: #4CAF50 !important;
        }

        body.dark-mode #datosTransferencia h4,
        body.dark-mode #datosTransferencia ul,
        body.dark-mode #datosTransferencia li {
            color: #A5D6A7 !important;
        }

        body.dark-mode #datosTransferencia strong {
            color: #81C784 !important;
        }

        /* Bloques informativos verdes en modo oscuro */
        body.dark-mode .info-box-green {
            background: rgba(232, 245, 233, 0.1) !important;
            border-left-color: #4CAF50 !important;
        }

        body.dark-mode .info-box-green h4,
        body.dark-mode .info-box-green ul,
        body.dark-mode .info-box-green li,
        body.dark-mode .info-box-green p {
            color: #A5D6A7 !important;
        }

        body.dark-mode .info-box-green strong {
            color: #81C784 !important;
        }

        body.dark-mode .alert {
            background: #252525;
            border-color: rgba(212, 175, 55, 0.3);
            color: #FFFFFF;
        }

        body.dark-mode .modal__container {
            background: linear-gradient(135deg, #1a1410 0%, #0a0a0a 100%);
            border: 1px solid rgba(212, 175, 55, 0.3);
            color: #FFFFFF;
        }

        body.dark-mode .modal__title {
            color: #FFD700;
        }

        body.dark-mode .modal__text {
            color: #E8E8E8;
        }

        /* Theme Toggle Button */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #D4AF37 0%, #FFD700 100%);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #0a0a0a;
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
            transition: all 0.3s;
            z-index: 1000;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.6);
        }

        .theme-toggle i {
            transition: transform 0.3s;
        }

        body.dark-mode .theme-toggle {
            background: linear-gradient(135deg, #FFD700 0%, #D4AF37 100%);
        }

        .theme-icon {
            position: absolute;
            transition: opacity 0.3s, transform 0.3s;
        }

        .theme-icon-sun {
            opacity: 1;
        }

        .theme-icon-moon {
            opacity: 0;
        }

        body.dark-mode .theme-icon-sun {
            opacity: 0;
            transform: rotate(180deg);
        }

        body.dark-mode .theme-icon-moon {
            opacity: 1;
            transform: rotate(0deg);
        }
    </style>
</head>
<body>

<!-- Theme Toggle Button -->
<button class="theme-toggle" id="theme-toggle" aria-label="Cambiar tema">
    <i class="fas fa-sun theme-icon theme-icon-sun"></i>
    <i class="fas fa-moon theme-icon theme-icon-moon"></i>
</button>

<!-- HEADER -->
<div class="header">
    <h1>üç∑ LicorPremium</h1>
    <p>√öltimo Paso para Comprar</p>
</div>

<!-- ALERTA -->
<div class="container">
    <div id="alertaError" class="alert alert-error">
        <i class="fas fa-exclamation-circle"></i> <span id="mensajeError"></span>
    </div>
    <div id="alertaExito" class="alert alert-success">
        <i class="fas fa-check-circle"></i> ¬°Compra realizada exitosamente!
    </div>
</div>

<!-- MAIN CONTENT -->
<div class="container">
    <div class="checkout-wrapper">
        
        <!-- FORMULARIO -->
        <form id="checkoutForm" class="checkout-form">
            
            <!-- SECCI√ìN ENV√çO -->
            <div class="form-section">
                <h2><i class="fas fa-shipping-fast"></i> M√©todo de Entrega</h2>
                
                <!-- SELECCI√ìN DE M√âTODO DE ENTREGA -->
                <div class="delivery-methods" style="margin-bottom: 25px;">
                    <div class="delivery-option" style="margin-bottom: 15px;">
                        <input type="radio" id="entregaDomicilio" name="metodoEntrega" value="domicilio" checked>
                        <label for="entregaDomicilio">
                            <i class="fas fa-truck"></i>
                            <div>
                                <strong>üöö Env√≠o a Domicilio</strong>
                                <span>Recibe tu pedido en la direcci√≥n que indiques</span>
                            </div>
                        </label>
                    </div>
                    
                    <div class="delivery-option">
                        <input type="radio" id="retiroTienda" name="metodoEntrega" value="retiro">
                        <label for="retiroTienda">
                            <i class="fas fa-store"></i>
                            <div>
                                <strong>üè™ Retiro en Tienda</strong>
                                <span>üéâ Gratis - Retira en cualquiera de nuestras sucursales</span>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- DATOS PARA ENV√çO A DOMICILIO -->
                <div id="datosEnvio" style="display: block;">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nombre Completo <span class="required">*</span></label>
                            <input type="text" name="nombre" placeholder="Juan P√©rez" required>
                            <span class="error-message" data-field="nombre"></span>
                        </div>
                        <div class="form-group">
                            <label>Tel√©fono <span class="required">*</span></label>
                            <input type="tel" name="telefono" placeholder="+56 9 XXXX XXXX" required>
                            <span class="error-message" data-field="telefono"></span>
                        </div>
                    </div>

                    <div class="form-row full">
                        <div class="form-group">
                            <label>Direcci√≥n <span class="required">*</span></label>
                            <input type="text" name="direccion" placeholder="Calle Principal 123, Apto 4B" required>
                            <span class="error-message" data-field="direccion"></span>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Ciudad <span class="required">*</span></label>
                            <input type="text" name="ciudad" placeholder="Santiago" required>
                            <span class="error-message" data-field="ciudad"></span>
                        </div>
                        <div class="form-group">
                            <label>C√≥digo Postal <span class="required">*</span></label>
                            <input type="text" name="codigoPostal" placeholder="8320000" required>
                            <span class="error-message" data-field="codigoPostal"></span>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Regi√≥n <span class="required">*</span></label>
                            <select name="region" required>
                                <option value="">-- Selecciona regi√≥n --</option>
                                <option value="RM">Regi√≥n Metropolitana</option>
                                <option value="V">Valpara√≠so</option>
                                <option value="VIII">Biob√≠o</option>
                                <option value="IX">La Araucan√≠a</option>
                                <option value="XIV">Los R√≠os</option>
                                <option value="X">Los Lagos</option>
                            </select>
                            <span class="error-message" data-field="region"></span>
                        </div>
                        <div class="form-group">
                            <label>Referencia (opcional)</label>
                            <input type="text" name="referencia" placeholder="Cerca de la estaci√≥n...">
                        </div>
                    </div>
                </div>

                <!-- DATOS PARA RETIRO EN TIENDA -->
                <div id="datosRetiro" style="display: none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nombre de quien retira <span class="required">*</span></label>
                            <input type="text" name="nombreRetiro" placeholder="Juan P√©rez">
                            <span class="error-message" data-field="nombreRetiro"></span>
                        </div>
                        <div class="form-group">
                            <label>Tel√©fono de contacto <span class="required">*</span></label>
                            <input type="tel" name="telefonoRetiro" placeholder="+56 9 XXXX XXXX">
                            <span class="error-message" data-field="telefonoRetiro"></span>
                        </div>
                    </div>

                    <div class="form-row full">
                        <div class="form-group">
                            <label>Selecciona la Sucursal <span class="required">*</span></label>
                            <select name="sucursal" style="padding: 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                                <option value="">-- Selecciona una sucursal --</option>
                                <option value="quito">üè™ Quito - Av. Amazonas y Naciones Unidas</option>
                                <option value="guayaquil">üè™ Guayaquil - Malec√≥n 2000, Local 15</option>
                                <option value="cuenca">üè™ Cuenca - Av. Ord√≥√±ez Lasso 123</option>
                            </select>
                            <span class="error-message" data-field="sucursal"></span>
                        </div>
                    </div>

                    <div class="info-box-green">
                        <h4><i class="fas fa-info-circle"></i> Instrucciones de Retiro</h4>
                        <ul>
                            <li>Tu pedido estar√° listo para retirar en <strong>24-48 horas</strong></li>
                            <li>Recibir√°s un <strong>correo electr√≥nico</strong> cuando est√© disponible</li>
                            <li>Presenta tu <strong>ticket de compra</strong> (impreso o en tu celular)</li>
                            <li>Trae tu <strong>c√©dula de identidad</strong> para verificaci√≥n</li>
                            <li>El pedido se guardar√° por <strong>7 d√≠as</strong> desde la notificaci√≥n</li>
                        </ul>
                        <p style="margin-top: 12px;">
                            <i class="fas fa-clock"></i> <strong>Horarios de atenci√≥n:</strong> Lunes a S√°bado 9:00 AM - 7:00 PM
                        </p>
                    </div>
                </div>
            </div>

            <!-- SECCI√ìN FACTURACI√ìN -->
            <div class="form-section">
                <h2><i class="fas fa-file-invoice"></i> Informaci√≥n de Facturaci√≥n</h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Correo Electr√≥nico <span class="required">*</span></label>
                        <input type="email" name="email" placeholder="juan@ejemplo.com" required>
                        <span class="error-message" data-field="email"></span>
                    </div>
                    <div class="form-group">
                        <label>RUC/C√©dula (opcional)</label>
                        <input type="text" name="ruc" placeholder="12.345.678-K">
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label>Nombre Empresa (opcional)</label>
                        <input type="text" name="empresa" placeholder="Restaurante XYZ">
                    </div>
                </div>
            </div>

            <!-- SECCI√ìN PAGO -->
            <div class="form-section">
                <h2><i class="fas fa-credit-card"></i> M√©todo de Pago</h2>
                
                <div class="payment-methods">
                    <div class="payment-option">
                        <input type="radio" id="tarjeta" name="metodoPago" value="tarjeta" checked>
                        <label for="tarjeta" class="payment-label">
                            <i class="fas fa-credit-card"></i> Tarjeta
                        </label>
                    </div>
                    <div class="payment-option">
                        <input type="radio" id="transferencia" name="metodoPago" value="transferencia">
                        <label for="transferencia" class="payment-label">
                            <i class="fas fa-bank"></i> Transferencia
                        </label>
                    </div>
                    <div class="payment-option">
                        <input type="radio" id="efectivo" name="metodoPago" value="efectivo">
                        <label for="efectivo" class="payment-label">
                            <i class="fas fa-money-bill"></i> Efectivo
                        </label>
                    </div>
                </div>

                <!-- DATOS TARJETA (mostrar solo si tarjeta est√° seleccionada) -->
                <div id="datosTarjeta" style="display: block; margin-top: 20px;">
                    <div class="form-row">
                        <div class="form-group">
                            <label>N√∫mero de Tarjeta <span class="required">*</span></label>
                            <input type="text" name="numeroTarjeta" placeholder="1234 5678 9012 3456" maxlength="19">
                            <span class="error-message" data-field="numeroTarjeta"></span>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Vencimiento <span class="required">*</span></label>
                            <input type="text" name="vencimiento" placeholder="MM/AA" maxlength="5">
                            <span class="error-message" data-field="vencimiento"></span>
                        </div>
                        <div class="form-group">
                            <label>CVV <span class="required">*</span></label>
                            <input type="text" name="cvv" placeholder="123" maxlength="3">
                            <span class="error-message" data-field="cvv"></span>
                        </div>
                    </div>

                    <div class="form-row full">
                        <div class="form-group">
                            <label>Titular de la Tarjeta <span class="required">*</span></label>
                            <input type="text" name="titularTarjeta" placeholder="JUAN PEREZ">
                            <span class="error-message" data-field="titularTarjeta"></span>
                        </div>
                    </div>
                </div>

                <!-- DATOS TRANSFERENCIA -->
                <div id="datosTransferencia" class="info-box-green" style="display: none;">
                    <h4><i class="fas fa-university"></i> Datos Bancarios</h4>
                    <ul>
                        <li><strong>Banco:</strong> Banco de Chile</li>
                        <li><strong>Cuenta:</strong> Corriente 1234567890</li>
                        <li><strong>Titular:</strong> La Licorer√≠a Online SpA</li>
                        <li><strong>RUT:</strong> 76.XXX.XXX-X</li>
                        <li style="margin-top: 10px; padding-top: 10px; border-top: 2px dashed #4CAF50;">
                            <i class="fas fa-info-circle"></i> <strong>Importante:</strong> Env√≠a el comprobante de transferencia a <strong>soporte@lalicoreria.com</strong>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- T√âRMINOS Y CONDICIONES -->
            <div class="form-section">
                <h2><i class="fas fa-shield-alt"></i> Confirmaci√≥n y Legal</h2>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="terminos" name="terminos" required>
                    <label for="terminos" class="checkbox-label">
                        He le√≠do y acepto los <a href="#" target="_blank">T√©rminos y Condiciones</a>
                    </label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="privacidad" name="privacidad" required>
                    <label for="privacidad" class="checkbox-label">
                        Acepto la <a href="#" target="_blank">Pol√≠tica de Privacidad</a>
                    </label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="mayorEdad" name="mayorEdad" required>
                    <label for="mayorEdad" class="checkbox-label">
                        <strong>‚úì Confirmo que soy mayor de 18 a√±os y compro bebidas alcoh√≥licas de manera responsable</strong>
                    </label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="newsletter" name="newsletter">
                    <label for="newsletter" class="checkbox-label">
                        Deseo recibir promociones y ofertas exclusivas (opcional)
                    </label>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;">
                    <button type="button" id="btn-cancelar-compra" class="btn btn--outline">
                        <i class="fas fa-times"></i> Cancelar Compra
                    </button>
                    <button type="button" id="btn-confirmar-pedido" class="btn btn--primary">
                        <i class="fas fa-lock"></i> Confirmar Compra
                    </button>
                </div>
            </div>
        </form>

        <!-- RESUMEN CARRITO -->
        <div class="order-summary">
            <h2><i class="fas fa-shopping-cart"></i> Resumen del Pedido</h2>

            <div class="cart-item">
                <div class="item-info">
                    <div class="item-name">Vino Carmenere 2020</div>
                    <div class="item-qty">Cantidad: 2</div>
                </div>
                <div class="item-price">$29.990</div>
            </div>

            <div class="cart-item">
                <div class="item-info">
                    <div class="item-name">Whisky Johnnie Walker</div>
                    <div class="item-qty">Cantidad: 1</div>
                </div>
                <div class="item-price">$34.990</div>
            </div>

            <div class="cart-item">
                <div class="item-info">
                    <div class="item-name">Cerveza Artesanal Pack</div>
                    <div class="item-qty">Cantidad: 3</div>
                </div>
                <div class="item-price">$19.990</div>
            </div>

            <div class="summary-row">
                <span class="summary-label">Subtotal:</span>
                <span class="summary-value">$84.970</span>
            </div>

            <div class="summary-row">
                <span class="summary-label">Env√≠o:</span>
                <span class="summary-value">$5.000</span>
            </div>

            <div class="summary-row">
                <span class="summary-label">Descuento:</span>
                <span class="summary-value">-$5.000</span>
            </div>

            <div class="summary-row total">
                <span>Total a Pagar:</span>
                <span>$84.970</span>
            </div>

            <div class="trust-badges">
                <div class="badge">
                    <i class="fas fa-lock"></i>
                    Pago Seguro
                </div>
                <div class="badge">
                    <i class="fas fa-check-circle"></i>
                    Garant√≠a
                </div>
                <div class="badge">
                    <i class="fas fa-headset"></i>
                    Soporte 24/7
                </div>
            </div>
        </div>
    </div>
</div>

<!-- LOADER -->
<div id="loader" class="loader">
    <div class="spinner"></div>
</div>

<!-- FOOTER -->
<footer style="background: #1a1a1a; color: white; padding: 20px; text-align: center; margin-top: 40px;">
    <p>&copy; 2025 La Licorer√≠a Online. Todos los derechos reservados. | 
        <a href="#" style="color: #D4AF37; text-decoration: none;">Pol√≠tica de Privacidad</a> | 
        <a href="#" style="color: #D4AF37; text-decoration: none;">Contacto</a>
    </p>
</footer>

<script>
    // ==================== THEME TOGGLE ====================
    const themeToggle = document.getElementById('theme-toggle');
    const body = document.body;
    
    // Cargar tema guardado
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
        body.classList.add('dark-mode');
    }
    
    // Toggle theme
    themeToggle.addEventListener('click', () => {
        body.classList.toggle('dark-mode');
        const isDark = body.classList.contains('dark-mode');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });

    // ==================== VALIDACIONES MEJORADAS ====================
    const validar = {
        email: (email) => {
            // Debe tener exactamente un @ y al menos un punto despu√©s del @
            const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            const atCount = (email.match(/@/g) || []).length;
            const afterAt = email.split('@')[1] || '';
            const dotAfterAt = afterAt.includes('.');
            return regex.test(email) && atCount === 1 && dotAfterAt;
        },
        
        telefono: (tel) => {
            // Acepta n√∫meros, espacios, + y guiones. M√≠nimo 8 d√≠gitos
            const soloNumeros = tel.replace(/[\s\-+]/g, '');
            return /^\d{8,15}$/.test(soloNumeros);
        },
        
        numeroTarjeta: (num) => {
            // Validaci√≥n Luhn Algorithm
            const soloNumeros = num.replace(/\s/g, '');
            if (!/^\d{13,19}$/.test(soloNumeros)) return false;
            
            let suma = 0;
            let alternar = false;
            for (let i = soloNumeros.length - 1; i >= 0; i--) {
                let digito = parseInt(soloNumeros[i]);
                if (alternar) {
                    digito *= 2;
                    if (digito > 9) digito -= 9;
                }
                suma += digito;
                alternar = !alternar;
            }
            return suma % 10 === 0;
        },
        
        vencimiento: (ven) => {
            if (!/^\d{2}\/\d{2}$/.test(ven)) return false;
            const [mes, anio] = ven.split('/').map(Number);
            if (mes < 1 || mes > 12) return false;
            
            // Validar que no est√© vencida
            const ahora = new Date();
            const anioActual = ahora.getFullYear() % 100;
            const mesActual = ahora.getMonth() + 1;
            
            if (anio < anioActual) return false;
            if (anio === anioActual && mes < mesActual) return false;
            
            return true;
        },
        
        cvv: (cvv) => /^\d{3,4}$/.test(cvv),
        
        codigoPostal: (cp) => /^\d{5,10}$/.test(cp),
        
        nombre: (nombre) => {
            // Solo letras, espacios, acentos y guiones. M√≠nimo 3 caracteres
            return /^[a-z√°√©√≠√≥√∫√±√ºA-Z√Å√â√ç√ì√ö√ë√ú\s\-]{3,50}$/.test(nombre.trim());
        },
        
        direccion: (dir) => {
            // Debe contener letras y n√∫meros. Al menos 5 caracteres
            const tieneLetras = /[a-zA-Z]/.test(dir);
            const tieneNumeros = /\d/.test(dir);
            return dir.length >= 5 && tieneLetras && tieneNumeros;
        },
        
        caracteres: (texto) => {
            // Validar uso correcto de comas, guiones y barras
            const caracteresValidos = /^[a-zA-Z0-9\s\-,./√°√©√≠√≥√∫√±√º√Å√â√ç√ì√ö√ë√ú]+$/;
            return caracteresValidos.test(texto);
        }
    };

    // ==================== ELEMENTOS ====================
    const formulario = document.getElementById('checkoutForm');
    const alertaError = document.getElementById('alertaError');
    const alertaExito = document.getElementById('alertaExito');
    const loader = document.getElementById('loader');
    const metodoPagoRadios = document.querySelectorAll('input[name="metodoPago"]');
    const datosTarjeta = document.getElementById('datosTarjeta');
    const datosTransferencia = document.getElementById('datosTransferencia');

    // ==================== CAMBIO M√âTODO PAGO ====================
    metodoPagoRadios.forEach(radio => {
        radio.addEventListener('change', () => {
            if (radio.value === 'tarjeta') {
                datosTarjeta.style.display = 'block';
                datosTransferencia.style.display = 'none';
            } else if (radio.value === 'transferencia') {
                datosTarjeta.style.display = 'none';
                datosTransferencia.style.display = 'block';
            } else {
                datosTarjeta.style.display = 'none';
                datosTransferencia.style.display = 'none';
            }
        });
    });

    // ==================== FORMATO TARJETA ====================
    const numeroTarjetaInput = document.querySelector('input[name="numeroTarjeta"]');
    numeroTarjetaInput?.addEventListener('input', (e) => {
        let valor = e.target.value.replace(/\s/g, '');
        let formateado = valor.replace(/(\d{4})/g, '$1 ').trim();
        e.target.value = formateado;
    });

    // ==================== FORMATO VENCIMIENTO ====================
    const vencimientoInput = document.querySelector('input[name="vencimiento"]');
    vencimientoInput?.addEventListener('input', (e) => {
        let valor = e.target.value.replace(/\D/g, '');
        if (valor.length >= 2) {
            valor = valor.slice(0, 2) + '/' + valor.slice(2, 4);
        }
        e.target.value = valor;
    });

    // ==================== CAMBIO M√âTODO ENTREGA ====================
    const metodoEntregaRadios = document.querySelectorAll('input[name="metodoEntrega"]');
    const datosEnvio = document.getElementById('datosEnvio');
    const datosRetiro = document.getElementById('datosRetiro');
    const envioLabel = document.querySelector('.summary-row:nth-child(2) .summary-value');

    metodoEntregaRadios.forEach(radio => {
        radio.addEventListener('change', () => {
            if (radio.value === 'domicilio') {
                datosEnvio.style.display = 'block';
                datosRetiro.style.display = 'none';
                // Activar campos de env√≠o
                datosEnvio.querySelectorAll('input, select').forEach(input => {
                    input.disabled = false;
                    if (input.hasAttribute('required-temp')) {
                        input.setAttribute('required', '');
                        input.removeAttribute('required-temp');
                    }
                });
                // Desactivar campos de retiro
                datosRetiro.querySelectorAll('input, select').forEach(input => {
                    input.disabled = true;
                    if (input.hasAttribute('required')) {
                        input.setAttribute('required-temp', '');
                        input.removeAttribute('required');
                    }
                });
                // Actualizar costo de env√≠o
                if (envioLabel) envioLabel.textContent = '$5.000';
                actualizarTotal();
            } else if (radio.value === 'retiro') {
                datosEnvio.style.display = 'none';
                datosRetiro.style.display = 'block';
                // Desactivar campos de env√≠o
                datosEnvio.querySelectorAll('input, select').forEach(input => {
                    input.disabled = true;
                    if (input.hasAttribute('required')) {
                        input.setAttribute('required-temp', '');
                        input.removeAttribute('required');
                    }
                });
                // Activar campos de retiro
                datosRetiro.querySelectorAll('input, select').forEach(input => {
                    input.disabled = false;
                    if (input.hasAttribute('required-temp')) {
                        input.setAttribute('required', '');
                        input.removeAttribute('required-temp');
                    }
                });
                // Actualizar costo de env√≠o (gratis)
                if (envioLabel) envioLabel.textContent = 'GRATIS';
                actualizarTotal();
            }
            
            // Destacar opci√≥n seleccionada
            document.querySelectorAll('.delivery-option label').forEach(label => {
                label.style.borderColor = '#ddd';
                label.style.background = 'white';
            });
            radio.parentElement.querySelector('label').style.borderColor = '#D4AF37';
            radio.parentElement.querySelector('label').style.background = '#FFF8F0';
        });
    });

    // Funci√≥n para actualizar el total
    function actualizarTotal() {
        const subtotal = 84970;
        const descuento = 5000;
        const envio = document.querySelector('input[name="metodoEntrega"]:checked').value === 'retiro' ? 0 : 5000;
        const total = subtotal - descuento + envio;
        
        document.querySelector('.summary-row.total span:last-child').textContent = 
            '$' + total.toLocaleString('es-CL');
    }

    // ==================== MOSTRAR/OCULTAR ERRORES ====================
    function mostrarError(field, mensaje) {
        const input = document.querySelector(`input[name="${field}"], select[name="${field}"]`);
        const errorMsg = document.querySelector(`span[data-field="${field}"]`);
        
        if (input) {
            input.classList.add('error');
            // Agregar efecto de shake
            input.style.animation = 'shake 0.5s';
            setTimeout(() => {
                input.style.animation = '';
            }, 500);
        }
        if (errorMsg) {
            errorMsg.textContent = mensaje;
            errorMsg.classList.add('show');
        }
    }

    function limpiarError(field) {
        const input = document.querySelector(`input[name="${field}"], select[name="${field}"]`);
        const errorMsg = document.querySelector(`span[data-field="${field}"]`);
        
        if (input) {
            input.classList.remove('error');
        }
        if (errorMsg) {
            errorMsg.classList.remove('show');
        }
    }

    // ==================== VALIDAR EN TIEMPO REAL ====================
    document.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"], select').forEach(field => {
        // Validar al salir del campo
        field.addEventListener('blur', () => {
            validarCampoIndividual(field);
        });

        // Limpiar error al empezar a escribir
        field.addEventListener('input', () => {
            if (field.classList.contains('error')) {
                limpiarError(field.name);
            }
        });
    });

    // Funci√≥n para validar un campo individual
    function validarCampoIndividual(field) {
        const valor = field.value.trim();
        const nombre = field.name;
        
        // Limpiar error previo
        limpiarError(nombre);

        if (!valor) return; // No validar si est√° vac√≠o (solo en blur)

        switch(nombre) {
            case 'email':
                if (!validar.email(valor)) {
                    mostrarError(nombre, '‚ùå Email debe tener un @ y al menos un punto despu√©s');
                } else {
                    mostrarExito(field, '‚úì Email v√°lido');
                }
                break;
            
            case 'telefono':
            case 'telefonoRetiro':
                if (!validar.telefono(valor)) {
                    mostrarError(nombre, '‚ùå Tel√©fono debe tener 8-15 d√≠gitos');
                } else {
                    mostrarExito(field, '‚úì Tel√©fono v√°lido');
                }
                break;
            
            case 'nombre':
            case 'nombreRetiro':
            case 'ciudad':
            case 'titularTarjeta':
                if (!validar.nombre(valor)) {
                    mostrarError(nombre, '‚ùå Solo letras, espacios y guiones permitidos');
                } else {
                    mostrarExito(field, '‚úì');
                }
                break;
            
            case 'direccion':
                if (!validar.direccion(valor)) {
                    mostrarError(nombre, '‚ùå Debe incluir letras y n√∫meros');
                } else {
                    mostrarExito(field, '‚úì Direcci√≥n v√°lida');
                }
                break;
            
            case 'codigoPostal':
                if (!validar.codigoPostal(valor)) {
                    mostrarError(nombre, '‚ùå 5-10 d√≠gitos requeridos');
                } else {
                    mostrarExito(field, '‚úì');
                }
                break;
            
            case 'numeroTarjeta':
                if (!validar.numeroTarjeta(valor)) {
                    mostrarError(nombre, '‚ùå N√∫mero de tarjeta inv√°lido');
                } else {
                    mostrarExito(field, '‚úì Tarjeta v√°lida');
                }
                break;
            
            case 'vencimiento':
                if (!validar.vencimiento(valor)) {
                    mostrarError(nombre, '‚ùå Formato MM/AA o tarjeta vencida');
                } else {
                    mostrarExito(field, '‚úì Vigente');
                }
                break;
            
            case 'cvv':
                if (!validar.cvv(valor)) {
                    mostrarError(nombre, '‚ùå 3-4 d√≠gitos requeridos');
                } else {
                    mostrarExito(field, '‚úì');
                }
                break;
        }
    }

    // Funci√≥n para mostrar √©xito
    function mostrarExito(field, mensaje) {
        field.classList.add('success');
        field.style.borderColor = '#4CAF50';
        
        // Agregar checkmark temporal
        const checkmark = field.parentElement.querySelector('.checkmark');
        if (checkmark) checkmark.remove();
        
        const check = document.createElement('span');
        check.className = 'checkmark';
        check.style.cssText = 'color: #4CAF50; font-weight: bold; margin-left: 8px; font-size: 14px;';
        check.textContent = mensaje;
        field.parentElement.appendChild(check);
        
        setTimeout(() => {
            check.remove();
            field.style.borderColor = '';
        }, 2000);
    }

    // ==================== MOSTRAR PROGRESO ====================
    function mostrarProgreso(mensaje, icono = 'spinner') {
        const loaderContent = document.querySelector('.loader');
        if (!loaderContent) return;
        
        loaderContent.innerHTML = `
            <div style="background: white; padding: 30px; border-radius: 12px; text-align: center; max-width: 300px;">
                ${icono === 'spinner' ? 
                    '<div class="spinner"></div>' : 
                    `<i class="fas fa-${icono}" style="font-size: 48px; color: #D4AF37; margin-bottom: 15px;"></i>`
                }
                <p style="margin-top: 15px; color: #333; font-weight: 600;">${mensaje}</p>
            </div>
        `;
        loaderContent.classList.add('show');
    }

    function ocultarProgreso() {
        const loaderContent = document.querySelector('.loader');
        if (loaderContent) {
            loaderContent.classList.remove('show');
        }
    }

    // ==================== ENVIAR FORMULARIO CON VALIDACIONES COMPLETAS ====================
    formulario.addEventListener('submit', async (e) => {
        e.preventDefault();

        // Prevenir m√∫ltiples env√≠os - buscar por ID en lugar de type="submit"
        const btnSubmit = document.getElementById('btn-confirmar-pedido');
        if (btnSubmit && btnSubmit.disabled) return;
        
        let textoOriginal = '<i class="fas fa-lock"></i> Confirmar Compra'; // Texto por defecto
        
        // Deshabilitar bot√≥n inmediatamente
        if (btnSubmit) {
            textoOriginal = btnSubmit.innerHTML; // Guardar el texto actual
            btnSubmit.disabled = true;
            btnSubmit.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Procesando...';
            btnSubmit.style.opacity = '0.6';
            btnSubmit.style.cursor = 'not-allowed';
        }

        // Limpiar errores previos
        document.querySelectorAll('.error-message').forEach(msg => msg.classList.remove('show'));
        document.querySelectorAll('.error').forEach(el => el.classList.remove('error'));
        alertaError?.classList.remove('show');
        alertaExito?.classList.remove('show');

        // Obtener datos
        const formData = new FormData(formulario);
        const datos = Object.fromEntries(formData);

        // ==================== VALIDACIONES COMPLETAS ====================
        let valido = true;
        let errores = [];

        // Validar m√©todo de entrega
        if (datos.metodoEntrega === 'domicilio') {
            // Nombre completo
            if (!datos.nombre || datos.nombre.trim().length < 3) {
                mostrarError('nombre', 'El nombre debe tener al menos 3 caracteres');
                errores.push('Nombre inv√°lido');
                valido = false;
            } else if (!validar.nombre(datos.nombre)) {
                mostrarError('nombre', 'El nombre solo puede contener letras, espacios y guiones');
                errores.push('Nombre contiene caracteres no permitidos');
                valido = false;
            }

            // Tel√©fono
            if (!datos.telefono || !validar.telefono(datos.telefono)) {
                mostrarError('telefono', 'Tel√©fono inv√°lido. Debe tener 8-15 d√≠gitos');
                errores.push('Tel√©fono inv√°lido');
                valido = false;
            }

            // Direcci√≥n
            if (!datos.direccion || !validar.direccion(datos.direccion)) {
                mostrarError('direccion', 'La direcci√≥n debe contener letras y n√∫meros');
                errores.push('Direcci√≥n incompleta');
                valido = false;
            }

            // Ciudad
            if (!datos.ciudad || !validar.nombre(datos.ciudad)) {
                mostrarError('ciudad', 'Ciudad inv√°lida');
                errores.push('Ciudad inv√°lida');
                valido = false;
            }

            // C√≥digo postal
            if (!datos.codigoPostal || !validar.codigoPostal(datos.codigoPostal)) {
                mostrarError('codigoPostal', 'C√≥digo postal debe tener 5-10 d√≠gitos');
                errores.push('C√≥digo postal inv√°lido');
                valido = false;
            }

            // Regi√≥n
            if (!datos.region) {
                mostrarError('region', 'Debe seleccionar una regi√≥n');
                errores.push('Regi√≥n no seleccionada');
                valido = false;
            }
        } else if (datos.metodoEntrega === 'retiro') {
            // Validar retiro en tienda
            if (!datos.nombreRetiro || !validar.nombre(datos.nombreRetiro)) {
                mostrarError('nombreRetiro', 'Nombre inv√°lido');
                errores.push('Nombre de quien retira inv√°lido');
                valido = false;
            }

            if (!datos.telefonoRetiro || !validar.telefono(datos.telefonoRetiro)) {
                mostrarError('telefonoRetiro', 'Tel√©fono inv√°lido');
                errores.push('Tel√©fono de contacto inv√°lido');
                valido = false;
            }

            if (!datos.sucursal) {
                mostrarError('sucursal', 'Debe seleccionar una sucursal');
                errores.push('Sucursal no seleccionada');
                valido = false;
            }
        }

        // Email (SIEMPRE REQUERIDO)
        if (!datos.email) {
            mostrarError('email', 'El correo electr√≥nico es requerido');
            errores.push('Email faltante');
            valido = false;
        } else if (!validar.email(datos.email)) {
            mostrarError('email', 'Email inv√°lido. Debe tener un @ y al menos un punto despu√©s');
            errores.push('Formato de email incorrecto');
            valido = false;
        }

        // Validaciones de pago seg√∫n m√©todo
        if (datos.metodoPago === 'tarjeta') {
            // N√∫mero de tarjeta
            if (!datos.numeroTarjeta || !validar.numeroTarjeta(datos.numeroTarjeta)) {
                mostrarError('numeroTarjeta', 'N√∫mero de tarjeta inv√°lido (verificaci√≥n Luhn)');
                errores.push('Tarjeta inv√°lida');
                valido = false;
            }

            // Vencimiento
            if (!datos.vencimiento || !validar.vencimiento(datos.vencimiento)) {
                mostrarError('vencimiento', 'Fecha de vencimiento inv√°lida o tarjeta vencida (MM/AA)');
                errores.push('Vencimiento inv√°lido');
                valido = false;
            }

            // CVV
            if (!datos.cvv || !validar.cvv(datos.cvv)) {
                mostrarError('cvv', 'CVV debe tener 3-4 d√≠gitos');
                errores.push('CVV inv√°lido');
                valido = false;
            }

            // Titular
            if (!datos.titularTarjeta || !validar.nombre(datos.titularTarjeta)) {
                mostrarError('titularTarjeta', 'Nombre del titular inv√°lido');
                errores.push('Titular de tarjeta inv√°lido');
                valido = false;
            }
        }

        // T√©rminos y condiciones
        if (!datos.terminos) {
            errores.push('Debe aceptar los t√©rminos y condiciones');
            valido = false;
        }

        if (!datos.privacidad) {
            errores.push('Debe aceptar la pol√≠tica de privacidad');
            valido = false;
        }

        if (!datos.mayorEdad) {
            errores.push('Debe confirmar que es mayor de 18 a√±os');
            valido = false;
        }

        // Si hay errores, mostrar resumen y scroll al primer error
        if (!valido) {
            // Restaurar bot√≥n
            if (btnSubmit) {
                btnSubmit.disabled = false;
                btnSubmit.innerHTML = textoOriginal;
                btnSubmit.style.opacity = '1';
                btnSubmit.style.cursor = 'pointer';
            }
            
            const alertError = document.getElementById('alertaError');
            const mensajeError = document.getElementById('mensajeError');
            if (alertError && mensajeError) {
                mensajeError.innerHTML = `
                    <strong>‚ö†Ô∏è Formulario incompleto - Por favor corrija los siguientes errores:</strong>
                    <ul style="margin: 10px 0 0 20px; text-align: left;">
                        ${errores.map(e => `<li>${e}</li>`).join('')}
                    </ul>
                    <p style="margin-top: 15px; font-size: 14px; color: #666;">
                        <i class="fas fa-info-circle"></i> Hemos resaltado los campos con problemas en rojo. 
                        Despl√°cese hacia abajo para corregirlos.
                    </p>
                `;
                alertError.classList.add('show');
                alertError.scrollIntoView({ behavior: 'smooth', block: 'start' });
                
                // Hacer scroll al primer campo con error despu√©s de 500ms
                setTimeout(() => {
                    const primerError = document.querySelector('.error-message.show');
                    if (primerError) {
                        const campoConError = primerError.previousElementSibling || primerError.parentElement.querySelector('input, select');
                        if (campoConError) {
                            campoConError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            campoConError.focus();
                        }
                    }
                }, 500);
            }
            return;
        }

        // ==================== PROCESO DE COMPRA CON TRANSPARENCIA ====================
        try {
            // Paso 1: Validando datos
            mostrarProgreso('üîç Validando datos...', 'spinner');
            await esperar(1000);

            // Paso 2: Procesando pago
            mostrarProgreso('üí≥ Procesando pago seguro...', 'spinner');
            await esperar(1500);

            // Paso 3: Confirmando pedido
            mostrarProgreso('üì¶ Confirmando su pedido...', 'spinner');
            await esperar(1000);

            // Paso 4: √âxito
            mostrarProgreso('‚úÖ ¬°Compra realizada exitosamente!', 'check-circle');
            
            // Guardar datos del pedido (simulado)
            const numeroPedido = 'PED-' + Date.now();
            localStorage.setItem('ultimoPedido', JSON.stringify({
                numero: numeroPedido,
                fecha: new Date().toISOString(),
                datos: datos,
                total: document.querySelector('.summary-row.total span:last-child').textContent
            }));

            // Mostrar mensaje de √©xito detallado
            await esperar(1500);
            ocultarProgreso();
            
            // Pre-llenar datos del modal post-compra
            const ppNombreInput = document.getElementById('pp-nombre');
            const ppEmailInput = document.getElementById('pp-email');
            const orderNumberSpan = document.getElementById('order-number');
            
            if (ppNombreInput) ppNombreInput.value = datos.nombre || '';
            if (ppEmailInput) ppEmailInput.value = datos.email || '';
            if (orderNumberSpan) orderNumberSpan.textContent = numeroPedido;
            
            // Limpiar carrito
            localStorage.removeItem('carritoItems');
            
            // Mostrar modal post-compra
            const postPurchaseModal = document.getElementById('post-purchase-modal');
            if (postPurchaseModal) {
                postPurchaseModal.classList.add('active');
            }

        } catch (error) {
            // Manejo de errores con explicaci√≥n clara
            ocultarProgreso();
            
            // Restaurar bot√≥n
            if (btnSubmit) {
                btnSubmit.disabled = false;
                btnSubmit.innerHTML = textoOriginal;
                btnSubmit.style.opacity = '1';
                btnSubmit.style.cursor = 'pointer';
            }
            
            const alertError = document.getElementById('alertaError');
            const mensajeError = document.getElementById('mensajeError');
            if (alertError && mensajeError) {
                mensajeError.innerHTML = `
                    <strong>‚ùå Error en el procesamiento del pago</strong><br>
                    <p style="margin-top: 10px;">
                        ${error.message || 'Ha ocurrido un error. Por favor, intente nuevamente o contacte a soporte.'}
                    </p>
                    <p style="margin-top: 10px; font-size: 13px;">
                        <strong>Qu√© hacer:</strong><br>
                        ‚Ä¢ Verifique su conexi√≥n a internet<br>
                        ‚Ä¢ Revise los datos ingresados<br>
                        ‚Ä¢ Si el problema persiste, cont√°ctenos al +56 9 XXXX XXXX
                    </p>
                `;
                alertError.classList.add('show');
                alertError.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
    });

    // Funci√≥n auxiliar para esperar
    function esperar(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    // ==================== CONFIRMAR MAYOR√çA DE EDAD AL CARGAR ====================
    window.addEventListener('load', () => {
        const mayorEdad = localStorage.getItem('mayorEdadConfirmado');
        if (!mayorEdad) {
            if (!confirm('‚ö†Ô∏è ¬øEres mayor de 18 a√±os? (Se requiere para continuar)')) {
                window.location.href = '/';
            } else {
                localStorage.setItem('mayorEdadConfirmado', 'true');
            }
        }
    });

    // ==================== MODAL POST-COMPRA ====================
    const postPurchaseModal = document.getElementById('post-purchase-modal');
    const closePostPurchaseBtn = document.getElementById('close-post-purchase');
    const skipAccountBtn = document.getElementById('skip-account-creation');
    const postPurchaseForm = document.getElementById('post-purchase-register-form');

    // Cerrar modal
    if (closePostPurchaseBtn) {
        closePostPurchaseBtn.addEventListener('click', () => {
            postPurchaseModal.classList.remove('active');
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 300);
        });
    }

    // Saltar creaci√≥n de cuenta
    if (skipAccountBtn) {
        skipAccountBtn.addEventListener('click', () => {
            postPurchaseModal.classList.remove('active');
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 300);
        });
    }

    // Click en overlay cierra modal
    postPurchaseModal?.querySelector('.modal__overlay')?.addEventListener('click', () => {
        skipAccountBtn.click();
    });

    // Formulario post-compra
    if (postPurchaseForm) {
        postPurchaseForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const nombre = document.getElementById('pp-nombre').value;
            const email = document.getElementById('pp-email').value;
            const password = document.getElementById('pp-password').value;
            
            // Validar contrase√±a
            if (password.length < 8) {
                alert('La contrase√±a debe tener al menos 8 caracteres');
                return;
            }
            
            // Guardar usuario en localStorage
            localStorage.setItem('userLoggedIn', 'true');
            localStorage.setItem('userEmail', email);
            localStorage.setItem('userName', nombre);
            localStorage.setItem('discountCoupon', 'BIENVENIDO10'); // Cup√≥n del 10%
            
            // Mostrar notificaci√≥n de √©xito
            alert('¬°Cuenta creada exitosamente! üéâ\n\nTu cup√≥n de 10% OFF: BIENVENIDO10\n\nRevisa tu email para m√°s detalles.');
            
            // Cerrar modal y redirigir
            postPurchaseModal.classList.remove('active');
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 300);
        });
    }

    // Toggle password visibility
    document.querySelectorAll('.toggle-password').forEach(btn => {
        btn.addEventListener('click', function() {
            const targetId = this.getAttribute('data-target');
            const input = document.getElementById(targetId);
            const icon = this.querySelector('i');
            
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        });
    });

    // ==================== MODAL DE CONFIRMACI√ìN DE COMPRA ====================
    window.addEventListener('load', () => {
        const btnConfirmarPedido = document.getElementById('btn-confirmar-pedido');
        const confirmModal = document.getElementById('confirm-purchase-modal');
        const confirmYesBtn = document.getElementById('confirm-yes');
        const confirmNoBtn = document.getElementById('confirm-no');

        console.log('btnConfirmarPedido:', btnConfirmarPedido);
        console.log('confirmModal:', confirmModal);

        // Abrir modal de confirmaci√≥n al hacer clic en "Confirmar Compra"
        if (btnConfirmarPedido) {
            btnConfirmarPedido.addEventListener('click', () => {
                console.log('Click en Confirmar Compra');
                console.log('Agregando clase active al modal');
                if (confirmModal) {
                    confirmModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    console.log('Clases del modal:', confirmModal.className);
                }
            });
        }

        // Bot√≥n "S√≠, confirmar pedido"
        if (confirmYesBtn) {
            confirmYesBtn.addEventListener('click', () => {
                console.log('Confirmado, enviando formulario');
                confirmModal.classList.remove('active');
                document.body.style.overflow = '';
                // Disparar el submit del formulario
                formulario.dispatchEvent(new Event('submit'));
            });
        }

        // Bot√≥n "No, revisar" o cerrar
        if (confirmNoBtn) {
            confirmNoBtn.addEventListener('click', () => {
                console.log('Cancelado, cerrando modal');
                confirmModal.classList.remove('active');
                document.body.style.overflow = '';
            });
        }

        // Cerrar con overlay
        confirmModal?.querySelector('.modal__overlay')?.addEventListener('click', () => {
            confirmModal.classList.remove('active');
            document.body.style.overflow = '';
        });

        confirmModal?.querySelector('.modal__close')?.addEventListener('click', () => {
            confirmModal.classList.remove('active');
            document.body.style.overflow = '';
        });
    });

    // ==================== MODAL DE CANCELAR COMPRA ====================
    window.addEventListener('load', () => {
        const btnCancelarCompra = document.getElementById('btn-cancelar-compra');
        const cancelModal = document.getElementById('cancel-purchase-modal');
        const cancelYesBtn = document.getElementById('cancel-yes');
        const cancelNoBtn = document.getElementById('cancel-no');

        // Abrir modal de cancelaci√≥n
        if (btnCancelarCompra) {
            btnCancelarCompra.addEventListener('click', () => {
                if (cancelModal) {
                    cancelModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                }
            });
        }

        // Bot√≥n "S√≠, cancelar" - Redirigir al carrito
        if (cancelYesBtn) {
            cancelYesBtn.addEventListener('click', () => {
                window.location.href = 'carrito.html';
            });
        }

        // Bot√≥n "No, continuar"
        if (cancelNoBtn) {
            cancelNoBtn.addEventListener('click', () => {
                cancelModal.classList.remove('active');
                document.body.style.overflow = '';
            });
        }

        // Cerrar con overlay y X
        cancelModal?.querySelector('.modal__overlay')?.addEventListener('click', () => {
            cancelModal.classList.remove('active');
            document.body.style.overflow = '';
        });

        cancelModal?.querySelector('.modal__close')?.addEventListener('click', () => {
            cancelModal.classList.remove('active');
            document.body.style.overflow = '';
        });
    });
</script>

<!-- Modal: Confirmaci√≥n de Compra -->
<div class="modal" id="confirm-purchase-modal" role="dialog" aria-modal="true">
    <div class="modal__overlay"></div>
    <div class="modal__container modal__container--confirm">
        <button class="modal__close" aria-label="Cerrar">
            <i class="fas fa-times"></i>
        </button>
        
        <div class="modal__content">
            <!-- Icono de advertencia -->
            <div class="modal__icon modal__icon--warning">
                <i class="fas fa-exclamation-circle"></i>
            </div>

            <!-- T√≠tulo -->
            <h2 class="modal__title">¬øConfirmar tu pedido?</h2>
            
            <!-- Descripci√≥n -->
            <p class="modal__text">
                Est√°s a punto de procesar tu compra. Verifica que todos los datos sean correctos antes de continuar.
            </p>

            <!-- Detalles del pedido -->
            <div class="confirm-details">
                <div class="confirm-row">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Productos seleccionados</span>
                </div>
                <div class="confirm-row">
                    <i class="fas fa-credit-card"></i>
                    <span>M√©todo de pago verificado</span>
                </div>
                <div class="confirm-row">
                    <i class="fas fa-shipping-fast"></i>
                    <span>Direcci√≥n de entrega confirmada</span>
                </div>
            </div>

            <!-- Advertencia -->
            <div class="warning-box">
                <i class="fas fa-info-circle"></i>
                <p><strong>Importante:</strong> Una vez confirmado, tu pedido ser√° procesado y se realizar√° el cargo correspondiente.</p>
            </div>

            <!-- Botones de acci√≥n -->
            <div class="modal__actions modal__actions--split">
                <button type="button" class="btn btn--outline" id="confirm-no">
                    <i class="fas fa-times"></i>
                    No, revisar
                </button>
                <button type="button" class="btn btn--primary" id="confirm-yes">
                    <i class="fas fa-check"></i>
                    S√≠, confirmar pedido
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal: Cancelar Compra -->
<div class="modal" id="cancel-purchase-modal" role="dialog" aria-modal="true">
    <div class="modal__overlay"></div>
    <div class="modal__container modal__container--confirm">
        <button class="modal__close" aria-label="Cerrar">
            <i class="fas fa-times"></i>
        </button>
        
        <div class="modal__content">
            <!-- Icono de advertencia -->
            <div class="modal__icon modal__icon--warning" style="background: linear-gradient(135deg, #FF6B6B 0%, #EE5A52 100%);">
                <i class="fas fa-exclamation-triangle"></i>
            </div>

            <!-- T√≠tulo -->
            <h2 class="modal__title">¬øCancelar tu compra?</h2>
            
            <!-- Descripci√≥n -->
            <p class="modal__text">
                Si cancelas ahora, perder√°s toda la informaci√≥n ingresada en este formulario.
            </p>

            <!-- Advertencia -->
            <div class="warning-box" style="background: rgba(255, 107, 107, 0.1); border-left-color: #FF6B6B;">
                <i class="fas fa-info-circle"></i>
                <p><strong>Ten en cuenta:</strong> Los productos permanecer√°n en tu carrito, pero deber√°s completar el formulario nuevamente si decides continuar.</p>
            </div>

            <!-- Botones de acci√≥n -->
            <div class="modal__actions modal__actions--split">
                <button type="button" class="btn btn--outline" id="cancel-no">
                    <i class="fas fa-arrow-left"></i>
                    No, continuar
                </button>
                <button type="button" class="btn" id="cancel-yes" style="background: linear-gradient(135deg, #FF6B6B 0%, #EE5A52 100%); color: white;">
                    <i class="fas fa-times"></i>
                    S√≠, cancelar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal: Invitaci√≥n Post-Compra -->
<div class="modal" id="post-purchase-modal" role="dialog" aria-modal="true">
    <div class="modal__overlay"></div>
    <div class="modal__container modal__container--post-purchase">
        <button class="modal__close" id="close-post-purchase" aria-label="Cerrar">
            <i class="fas fa-times"></i>
        </button>
        
        <div class="modal__content">
            <!-- Icono de √©xito -->
            <div class="modal__icon modal__icon--success">
                <i class="fas fa-check-circle"></i>
            </div>

            <!-- T√≠tulo principal -->
            <h2 class="modal__title">¬°Pedido Realizado con √âxito! üéâ</h2>
            <p class="modal__subtitle">
                Tu pedido <strong>#<span id="order-number"></span></strong> ha sido confirmado
            </p>

            <!-- Badge de incentivo -->
            <div class="incentive-badge">
                <div class="incentive-badge__icon">
                    <i class="fas fa-gift"></i>
                </div>
                <div class="incentive-badge__content">
                    <h3>¬°Obt√©n 10% de Descuento!</h3>
                    <p>Crea tu cuenta AHORA y te enviaremos un cup√≥n v√°lido para tu pr√≥xima compra</p>
                </div>
            </div>

            <!-- Beneficios de crear cuenta -->
            <div class="benefits-list">
                <h4>Beneficios de tener una cuenta:</h4>
                <ul>
                    <li>
                        <i class="fas fa-check-circle"></i>
                        <span><strong>10% OFF</strong> en tu siguiente compra</span>
                    </li>
                    <li>
                        <i class="fas fa-history"></i>
                        <span>Rastrea este y todos tus pedidos</span>
                    </li>
                    <li>
                        <i class="fas fa-shipping-fast"></i>
                        <span>Checkout m√°s r√°pido en futuras compras</span>
                    </li>
                    <li>
                        <i class="fas fa-tag"></i>
                        <span>Ofertas exclusivas por email</span>
                    </li>
                    <li>
                        <i class="fas fa-heart"></i>
                        <span>Guarda tus productos favoritos</span>
                    </li>
                </ul>
            </div>

            <!-- Formulario de creaci√≥n r√°pida -->
            <form class="quick-register-form" id="post-purchase-register-form">
                <div class="form-group">
                    <label for="pp-nombre">
                        <i class="fas fa-user"></i> Nombre Completo
                    </label>
                    <input 
                        type="text" 
                        id="pp-nombre" 
                        name="nombre" 
                        placeholder="Juan P√©rez"
                        required
                        minlength="3"
                    >
                    <span class="error-msg" data-field="pp-nombre"></span>
                </div>

                <div class="form-group">
                    <label for="pp-email">
                        <i class="fas fa-envelope"></i> Correo Electr√≥nico
                    </label>
                    <input 
                        type="email" 
                        id="pp-email" 
                        name="email" 
                        placeholder="tu@email.com"
                        required
                        readonly
                    >
                    <small class="field-help">Usamos el email de tu compra</small>
                </div>

                <div class="form-group">
                    <label for="pp-password">
                        <i class="fas fa-lock"></i> Crear Contrase√±a
                    </label>
                    <div class="password-input-wrapper">
                        <input 
                            type="password" 
                            id="pp-password" 
                            name="password" 
                            placeholder="M√≠nimo 8 caracteres"
                            required
                            minlength="8"
                        >
                        <button type="button" class="toggle-password" data-target="pp-password">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <span class="error-msg" data-field="pp-password"></span>
                </div>

                <div class="form-group">
                    <label class="checkbox-label-block">
                        <input type="checkbox" name="newsletter" checked>
                        <span>Quiero recibir ofertas exclusivas por email</span>
                    </label>
                </div>

                <!-- Botones de acci√≥n -->
                <div class="modal__actions">
                    <button type="submit" class="btn btn--primary btn--lg btn--block">
                        <i class="fas fa-gift"></i>
                        Crear Cuenta y Obtener 10% OFF
                    </button>
                    <button type="button" class="btn btn--text btn--block" id="skip-account-creation">
                        No gracias, continuar sin cuenta
                    </button>
                </div>
            </form>

            <!-- Mensaje de seguridad -->
            <p class="security-note">
                <i class="fas fa-shield-alt"></i>
                Tu informaci√≥n est√° protegida. No compartimos tus datos.
            </p>
        </div>
    </div>
</div>

<style>
    /* ==================== MODAL POST-COMPRA STYLES ==================== */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 10000;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .modal.active {
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 1;
    }

    .modal__overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        backdrop-filter: blur(8px);
    }

    .modal__container {
        position: relative;
        max-width: 600px;
        max-height: 90vh;
        overflow-y: auto;
        background: linear-gradient(135deg, #1a1410 0%, #0a0a0a 100%);
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(212, 175, 55, 0.3);
        border: 1px solid rgba(212, 175, 55, 0.2);
        animation: modalSlideUp 0.4s ease-out;
        margin: 20px;
    }

    @keyframes modalSlideUp {
        from {
            transform: translateY(50px);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }

    .modal__close {
        position: absolute;
        top: 20px;
        right: 20px;
        background: rgba(212, 175, 55, 0.1);
        border: 1px solid rgba(212, 175, 55, 0.3);
        color: #D4AF37;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 18px;
        z-index: 10;
    }

    .modal__close:hover {
        background: #D4AF37;
        color: #0a0a0a;
        transform: rotate(90deg);
    }

    .modal__content {
        padding: 40px;
        color: #f5f5f5;
    }

    .modal__icon--success {
        width: 80px;
        height: 80px;
        background: linear-gradient(135deg, #D4AF37 0%, #FFD700 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
        box-shadow: 0 10px 30px rgba(212, 175, 55, 0.4);
        animation: successPulse 1.5s infinite;
    }

    .modal__icon--success i {
        font-size: 40px;
        color: #0a0a0a;
    }

    @keyframes successPulse {
        0%, 100% {
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.4);
        }
        50% {
            box-shadow: 0 10px 40px rgba(212, 175, 55, 0.6);
        }
    }

    .modal__title {
        font-size: 28px;
        font-weight: 700;
        text-align: center;
        margin-bottom: 10px;
        background: linear-gradient(135deg, #D4AF37 0%, #FFD700 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .modal__subtitle {
        text-align: center;
        color: #b0b0b0;
        margin-bottom: 30px;
        font-size: 16px;
    }

    .modal__subtitle strong {
        color: #D4AF37;
    }

    .incentive-badge {
        background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(212, 175, 55, 0.05) 100%);
        border: 2px solid rgba(212, 175, 55, 0.3);
        border-radius: 12px;
        padding: 20px;
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 25px;
    }

    .incentive-badge__icon {
        width: 60px;
        height: 60px;
        background: #D4AF37;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }

    .incentive-badge__icon i {
        font-size: 28px;
        color: #0a0a0a;
    }

    .incentive-badge__content h3 {
        font-size: 20px;
        color: #D4AF37;
        margin-bottom: 5px;
        font-weight: 700;
    }

    .incentive-badge__content p {
        font-size: 14px;
        color: #d0d0d0;
        margin: 0;
    }

    .benefits-list {
        margin-bottom: 25px;
    }

    .benefits-list h4 {
        font-size: 16px;
        color: #f5f5f5;
        margin-bottom: 15px;
        font-weight: 600;
    }

    .benefits-list ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .benefits-list li {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px 0;
        border-bottom: 1px solid rgba(212, 175, 55, 0.1);
    }

    .benefits-list li:last-child {
        border-bottom: none;
    }

    .benefits-list li i {
        color: #D4AF37;
        font-size: 18px;
        flex-shrink: 0;
    }

    .benefits-list li span {
        color: #d0d0d0;
        font-size: 14px;
    }

    .benefits-list li strong {
        color: #D4AF37;
    }

    .quick-register-form .form-group {
        margin-bottom: 20px;
    }

    .quick-register-form label {
        display: block;
        color: #f5f5f5;
        margin-bottom: 8px;
        font-weight: 600;
        font-size: 14px;
    }

    .quick-register-form label i {
        color: #D4AF37;
        margin-right: 8px;
    }

    .quick-register-form input[type="text"],
    .quick-register-form input[type="email"],
    .quick-register-form input[type="password"] {
        width: 100%;
        padding: 12px 15px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(212, 175, 55, 0.2);
        border-radius: 8px;
        color: #f5f5f5;
        font-size: 14px;
        transition: all 0.3s ease;
    }

    .quick-register-form input:focus {
        outline: none;
        border-color: #D4AF37;
        background: rgba(255, 255, 255, 0.08);
        box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
    }

    .quick-register-form input[readonly] {
        background: rgba(255, 255, 255, 0.02);
        cursor: not-allowed;
    }

    .password-input-wrapper {
        position: relative;
    }

    .password-input-wrapper input {
        padding-right: 45px;
    }

    .toggle-password {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        color: #D4AF37;
        cursor: pointer;
        padding: 8px;
        transition: all 0.3s ease;
    }

    .toggle-password:hover {
        color: #FFD700;
    }

    .field-help {
        display: block;
        margin-top: 5px;
        font-size: 12px;
        color: #888;
    }

    .checkbox-label-block {
        display: flex;
        align-items: center;
        gap: 10px;
        cursor: pointer;
    }

    .checkbox-label-block input[type="checkbox"] {
        width: 18px;
        height: 18px;
        cursor: pointer;
    }

    .checkbox-label-block span {
        color: #d0d0d0;
        font-size: 14px;
    }

    .modal__actions {
        margin-top: 25px;
    }

    .btn {
        padding: 14px 24px;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 16px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        border: none;
        width: 100%;
        margin-bottom: 10px;
    }

    .btn--primary {
        background: linear-gradient(135deg, #D4AF37 0%, #FFD700 100%);
        color: #0a0a0a;
        box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
    }

    .btn--primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
    }

    .btn--text {
        background: transparent;
        color: #888;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .btn--text:hover {
        color: #f5f5f5;
        border-color: rgba(212, 175, 55, 0.3);
    }

    .security-note {
        text-align: center;
        font-size: 12px;
        color: #888;
        margin-top: 20px;
    }

    .security-note i {
        color: #D4AF37;
        margin-right: 5px;
    }

    .error-msg {
        display: block;
        color: #ff6b6b;
        font-size: 12px;
        margin-top: 5px;
    }

    /* ==================== MODAL DE CONFIRMACI√ìN ==================== */
    .modal__container--confirm {
        max-width: 500px;
    }

    .modal__icon--warning {
        width: 80px;
        height: 80px;
        background: linear-gradient(135deg, #FFA500 0%, #FF8C00 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
        box-shadow: 0 10px 30px rgba(255, 165, 0, 0.4);
        animation: warningPulse 1.5s infinite;
    }

    .modal__icon--warning i {
        font-size: 40px;
        color: #fff;
    }

    @keyframes warningPulse {
        0%, 100% {
            box-shadow: 0 10px 30px rgba(255, 165, 0, 0.4);
        }
        50% {
            box-shadow: 0 10px 40px rgba(255, 165, 0, 0.6);
        }
    }

    .modal__text {
        text-align: center;
        color: #b0b0b0;
        margin-bottom: 25px;
        font-size: 15px;
        line-height: 1.6;
    }

    .confirm-details {
        background: rgba(212, 175, 55, 0.05);
        border: 1px solid rgba(212, 175, 55, 0.2);
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
    }

    .confirm-row {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px 0;
        color: #d0d0d0;
        font-size: 14px;
    }

    .confirm-row:not(:last-child) {
        border-bottom: 1px solid rgba(212, 175, 55, 0.1);
    }

    .confirm-row i {
        color: #D4AF37;
        font-size: 18px;
        width: 24px;
        text-align: center;
    }

    .warning-box {
        background: linear-gradient(135deg, rgba(255, 165, 0, 0.1) 0%, rgba(255, 140, 0, 0.05) 100%);
        border: 1px solid rgba(255, 165, 0, 0.3);
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 25px;
        display: flex;
        align-items: flex-start;
        gap: 12px;
    }

    .warning-box i {
        color: #FFA500;
        font-size: 20px;
        margin-top: 2px;
        flex-shrink: 0;
    }

    .warning-box p {
        margin: 0;
        font-size: 13px;
        color: #d0d0d0;
        line-height: 1.5;
    }

    .warning-box strong {
        color: #FFA500;
    }

    .modal__actions--split {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
    }

    .btn--outline {
        background: transparent;
        color: #888;
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .btn--outline:hover {
        color: #f5f5f5;
        border-color: rgba(212, 175, 55, 0.4);
        background: rgba(255, 255, 255, 0.02);
    }

    /* Responsive */
    @media (max-width: 768px) {
        .modal__container {
            max-width: 95%;
            margin: 10px;
        }

        .modal__content {
            padding: 30px 20px;
        }

        .modal__title {
            font-size: 24px;
        }

        .incentive-badge {
            flex-direction: column;
            text-align: center;
        }

        .modal__actions--split {
            grid-template-columns: 1fr;
        }
    }
</style>

</body>
</html>